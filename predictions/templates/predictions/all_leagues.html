{% extends 'predictions/user-base.html' %}
{% block title %} All leagues{% endblock  %}
{% block og_title %} All leagues{% endblock  %}
{% block content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    </li>
    {% endfor %}
</ul>
{% endif %}
<div class="dashboard-single">
{% for league in leagues %}
  <header>
    <h2>{{league.league}}</h2>
    <button class="btn btn-primary text-white" data-removed="Removed" data-removing="Removing..." data-loading="Adding..." data-loaded="Added" data-stage="add" @click="addWatchlist($event,{{league.id}})">Add to watchlist</button>
    <div class="dropdown">
        <button type="button" class="clicker dropdown-toggle" type="button" id="dropdownMenu2" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="27" height="32" viewBox="0 0 27 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M23 17.2273V14.3793H21V17.6832C21.0001 17.9752 21.1054 18.2553 21.293 18.4618L24 21.443V23.1897H2V21.443L4.707 18.4618C4.89455 18.2553 4.99994 17.9752 5 17.6832V13.278C4.99721 11.7305 5.3653 10.2095 6.06709 8.86879C6.76887 7.52805 7.7795 6.41502 8.9969 5.6421C10.2143 4.86918 11.5953 4.46375 13.0005 4.46677C14.4058 4.46978 15.7853 4.88113 17 5.65927V3.19788C16.0481 2.73371 15.0356 2.43786 14 2.32125V0.0625H12V2.32015C9.53457 2.5965 7.24976 3.8698 5.58737 5.89383C3.92498 7.91786 3.0031 10.5488 3 13.278V17.2273L0.293 20.2085C0.105451 20.4149 5.66374e-05 20.695 0 20.9871V24.2909C0 24.583 0.105357 24.8631 0.292893 25.0697C0.48043 25.2762 0.734784 25.3922 1 25.3922H8V26.4935C8 27.9539 8.52678 29.3545 9.46447 30.3872C10.4021 31.4199 11.6739 32 13 32C14.3261 32 15.5979 31.4199 16.5355 30.3872C17.4732 29.3545 18 27.9539 18 26.4935V25.3922H25C25.2652 25.3922 25.5196 25.2762 25.7071 25.0697C25.8946 24.8631 26 24.583 26 24.2909V20.9871C25.9999 20.695 25.8946 20.4149 25.707 20.2085L23 17.2273ZM16 26.4935C16 27.3698 15.6839 28.2101 15.1213 28.8297C14.5587 29.4493 13.7956 29.7974 13 29.7974C12.2044 29.7974 11.4413 29.4493 10.8787 28.8297C10.3161 28.2101 10 27.3698 10 26.4935V25.3922H16V26.4935Z" fill="#A3A5AF"/>
                <path d="M23 12.1767C25.2091 12.1767 27 10.2045 27 7.77157C27 5.33866 25.2091 3.36639 23 3.36639C20.7909 3.36639 19 5.33866 19 7.77157C19 10.2045 20.7909 12.1767 23 12.1767Z" fill="#A3A5AF"/>
            </svg>  
            {% for dropdown in league_types %}
                {% if dropdown.league == league.id %}
                    <span>{% with dropdown.types|first as first_type %}{{ first_type.name }}{% endwith %}</span>
                {% endif %}       
            {% endfor %}

        </button>
        <ul class="dropdown-menu league_list_main" id="league_list_main" aria-labelledby="dropdownMenu2" data-identifier={{ league.id }}>
            {% for dropdown in league_types %}
                {% if dropdown.league == league.id %}
                    {% for types in dropdown.types %}
                        <li data-value="{{ types.data }}">
                            {{ types.name }}
                        </li> 
                    {% endfor %} 
                {% endif %}
            {% endfor %}  
        </ul>
    </div>
  </header>
    <div class="table-responsive table-container">
        <table class="table">
            <thead>
                <tr>
                    <th class="w-auto" scope="col">Home</th>
                    <th class="w-auto" scope="col">Away</th>
                    {% for dropdown in league_types %}
                        {% if dropdown.league == league.id %}
                            {% with dropdown.types|first as first_type %}
                                {% if "correct_score" == first_type.data %}
                                    <th class="w-auto" scope="col">Correct score</th>
                                    <th class="w-auto" scope="col">Tip</th>
    
                                {% elif "halftime_correct_score" == first_type.data %}
                                    <th class="w-auto" scope="col">Halftime Correct scores</th>
    
                                {% elif "combo_draws" == first_type.data %}
                                    <th class="w-auto" scope="col">Combo Draws</th>
    
                                {% elif "combo_tickets" == first_type.data %}
                                    <th class="w-auto" scope="col">Combo Tickets</th>
                                {% endif %} 
                            {% endwith %}
                        {% endif %}
                    {% endfor %} 
                </tr>
            </thead>
            <tbody>
                {% for predict in league.prediction.all %}
                    {% if  predict.type == "freemium" %}
                        {% for dropdown in league_types %}
                            {% if dropdown.league == league.id %}
                            {% with dropdown.types|first as first_type %}
                                    {% if first_type.data == "correct_score" %}
                                        {% if predict.correct_score != "" %}
                                            <predict :predict="{{ predict.serialize }}" :command="'correct_score'"></predict>
                                        {% endif %}  
    
                                    {% elif first_type.data == "halftime_correct_score" %}
                                        {% if predict.halftime_correct_score != "" %}
                                            <predict :predict="{{ predict.serialize }}" :command="'halftime_correct_score'"></predict>
                                        {% endif %} 
    
                                    {% elif first_type.data == "combo_draws" %}
                                        {% if predict.combo_draws != "" %}
                                            <predict :predict="{{ predict.serialize }}" :command="'combo_draws'"></predict>
                                        {% endif %} 
    
                                    {% elif first_type.data == "combo_tickets" %}
                                        {% if predict.combo_tickets != "" %}
                                            <predict :predict="{{ predict.serialize }}" :command="'combo_tickets'"></predict>
                                        {% endif %} 
                                    {% endif %}
                            {% endwith %}
                            {% endif %}       
                        {% endfor %}
                    
                    {% elif predict.type == "premium" and user.type == "premium" and user.premium.activated %}
                        {% for dropdown in league_types %}
                            {% if dropdown.league == league.id %}
                                {% with dropdown.types|first as first_type %}
                                        {% if first_type.data == "correct_score" %}
                                            {% if predict.correct_score != "" %}
                                                <predict :predict="{{ predict.serialize }}" :command="'correct_score'"></predict>
                                            {% endif %}  
    
                                        {% elif first_type.data == "halftime_correct_score" %}
                                            {% if predict.halftime_correct_score != "" %}
                                                <predict :predict="{{ predict.serialize }}" :command="'halftime_correct_score'"></predict>
                                            {% endif %} 
    
                                        {% elif first_type.data == "combo_draws" %}
                                            {% if predict.combo_draws != "" %}
                                                <predict :predict="{{ predict.serialize }}" :command="'combo_draws'"></predict>
                                            {% endif %} 
    
                                        {% elif first_type.data == "combo_tickets" %}
                                            {% if predict.combo_tickets != "" %}
                                                <predict :predict="{{ predict.serialize }}" :command="'combo_tickets'"></predict>
                                            {% endif %} 
                                        {% endif %}
                                {% endwith %}
                            {% endif %}       
                        {% endfor %}
                    {% endif %}
                {% empty %}
                    <tr><td>No picks now,check back later</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{%empty%}
<p>No leagues now,check back later</p>
{% endfor %}
</div>
{% endblock  %}